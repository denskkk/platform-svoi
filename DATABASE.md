# üìä –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö - –°–í–Ü–ô –î–õ–Ø –°–í–û–á–•

## –ó–º—ñ—Å—Ç
- [–û–≥–ª—è–¥](#–æ–≥–ª—è–¥)
- [ER –î—ñ–∞–≥—Ä–∞–º–∞](#er-–¥—ñ–∞–≥—Ä–∞–º–∞)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—å](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ç–∞–±–ª–∏—Ü—å)
- [–ó–≤'—è–∑–∫–∏](#–∑–≤—è–∑–∫–∏)
- [–Ü–Ω–¥–µ–∫—Å–∏](#—ñ–Ω–¥–µ–∫—Å–∏)
- [–¢—Ä–∏–≥–µ—Ä–∏](#—Ç—Ä–∏–≥–µ—Ä–∏)
- [–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è](#–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è)

---

## –û–≥–ª—è–¥

–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∞ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏ "–°–í–Ü–ô –î–õ–Ø –°–í–û–á–•" - —Å–æ—Ü—ñ–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ –¥–ª—è –ø–æ—à—É–∫—É —Ç–∞ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó –ø–æ—Å–ª—É–≥.

### –¢–µ—Ö–Ω—ñ—á–Ω—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

- **–°–£–ë–î**: PostgreSQL 12+
- **–ö–æ–¥—É–≤–∞–Ω–Ω—è**: UTF-8 (–ø—ñ–¥—Ç—Ä–∏–º–∫–∞ —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤)
- **–ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è**: 3NF
- **ORM**: Prisma
- **–†–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤–∞ —î–º–Ω—ñ—Å—Ç—å**: –¥–æ 10,000 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

### –û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- ‚úÖ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ —Ç–∞ —Ä–æ–ª—è–º–∏ (user, business, viewer, admin)
- ‚úÖ –ö–∞—Ç–∞–ª–æ–≥ –ø–æ—Å–ª—É–≥ –∑ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≤—ñ–¥–≥—É–∫—ñ–≤ —Ç–∞ —Ä–µ–π—Ç–∏–Ω–≥—ñ–≤
- ‚úÖ –û–±–º—ñ–Ω –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏
- ‚úÖ –û–±—Ä–∞–Ω–µ —Ç–∞ –∑–∞–∫–ª–∞–¥–∫–∏
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å–ø–æ–≤—ñ—â–µ–Ω—å
- ‚úÖ –°–∫–∞—Ä–≥–∏ —Ç–∞ –º–æ–¥–µ—Ä–∞—Ü—ñ—è
- ‚úÖ –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ –ø–æ—à—É–∫—ñ–≤

---

## ER –î—ñ–∞–≥—Ä–∞–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   USERS     ‚îÇ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÇ  SERVICES    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ CATEGORIES  ‚îÇ
‚îÇ             ‚îÇ   ‚îÇ   ‚îÇ              ‚îÇ       ‚îÇ             ‚îÇ
‚îÇ user_id (PK)‚îÇ   ‚îÇ   ‚îÇ service_id   ‚îÇ       ‚îÇ category_id ‚îÇ
‚îÇ role        ‚îÇ   ‚îÇ   ‚îÇ user_id (FK) ‚îÇ       ‚îÇ name        ‚îÇ
‚îÇ email       ‚îÇ   ‚îÇ   ‚îÇ category_id  ‚îÇ       ‚îÇ slug        ‚îÇ
‚îÇ city        ‚îÇ   ‚îÇ   ‚îÇ title        ‚îÇ       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ avg_rating  ‚îÇ   ‚îÇ   ‚îÇ price        ‚îÇ
‚îÇ is_verified ‚îÇ   ‚îÇ   ‚îÇ              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ          ‚îÇ
       ‚îÇ          ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
       ‚îÇ          ‚îî‚îÄ‚îÄ‚îÄ‚îÇ BUSINESS_INFO‚îÇ
       ‚îÇ              ‚îÇ              ‚îÇ
       ‚îÇ              ‚îÇ user_id (FK) ‚îÇ
       ‚îÇ              ‚îÇ company_name ‚îÇ
       ‚îÇ              ‚îÇ work_hours   ‚îÇ
       ‚îÇ              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
       ‚îÇ              ‚îÇ              ‚îÇ              ‚îÇ              ‚îÇ
       ‚ñº              ‚ñº              ‚ñº              ‚ñº              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ REVIEWS  ‚îÇ   ‚îÇ MESSAGES ‚îÇ   ‚îÇFAVORITES ‚îÇ   ‚îÇ REPORTS  ‚îÇ   ‚îÇSESSIONS  ‚îÇ
‚îÇ          ‚îÇ   ‚îÇ          ‚îÇ   ‚îÇ          ‚îÇ   ‚îÇ          ‚îÇ   ‚îÇ          ‚îÇ
‚îÇreviewer  ‚îÇ   ‚îÇsender    ‚îÇ   ‚îÇuser_id   ‚îÇ   ‚îÇreporter  ‚îÇ   ‚îÇuser_id   ‚îÇ
‚îÇreviewed  ‚îÇ   ‚îÇreceiver  ‚îÇ   ‚îÇtarget    ‚îÇ   ‚îÇreported  ‚îÇ   ‚îÇtoken     ‚îÇ
‚îÇrating    ‚îÇ   ‚îÇtext      ‚îÇ   ‚îÇ          ‚îÇ   ‚îÇreason    ‚îÇ   ‚îÇ          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇNOTIFICATIONS ‚îÇ       ‚îÇ  CITIES      ‚îÇ
‚îÇ              ‚îÇ       ‚îÇ              ‚îÇ
‚îÇ user_id (FK) ‚îÇ       ‚îÇ name         ‚îÇ
‚îÇ type         ‚îÇ       ‚îÇ region       ‚îÇ
‚îÇ message      ‚îÇ       ‚îÇ users_count  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SEARCH_LOGS  ‚îÇ
‚îÇ              ‚îÇ
‚îÇ user_id (FK) ‚îÇ
‚îÇ query        ‚îÇ
‚îÇ results      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—å

### 1. **users** - –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ
–û—Å–Ω–æ–≤–Ω–∞ —Ç–∞–±–ª–∏—Ü—è –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å |
|------|-----|------|
| `user_id` | SERIAL PRIMARY KEY | –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä |
| `role` | VARCHAR(20) | –†–æ–ª—å: user, business, viewer, admin |
| `first_name` | VARCHAR(100) | –Ü–º'—è |
| `last_name` | VARCHAR(100) | –ü—Ä—ñ–∑–≤–∏—â–µ |
| `email` | VARCHAR(255) UNIQUE | Email (—É–Ω—ñ–∫–∞–ª—å–Ω–∏–π) |
| `phone` | VARCHAR(20) | –¢–µ–ª–µ—Ñ–æ–Ω |
| `password_hash` | VARCHAR(255) | –•–µ—à –ø–∞—Ä–æ–ª—è (bcrypt) |
| `avatar_url` | TEXT | URL –∞–≤–∞—Ç–∞—Ä–∞ |
| `city` | VARCHAR(100) | –ú—ñ—Å—Ç–æ |
| `region` | VARCHAR(100) | –†–∞–π–æ–Ω/–æ–±–ª–∞—Å—Ç—å |
| `gender` | VARCHAR(10) | –°—Ç–∞—Ç—å |
| `age` | INTEGER | –í—ñ–∫ |
| `bio` | TEXT | –ë—ñ–æ–≥—Ä–∞—Ñ—ñ—è |
| `avg_rating` | DECIMAL(3,2) | –°–µ—Ä–µ–¥–Ω—ñ–π —Ä–µ–π—Ç–∏–Ω–≥ (0.00-5.00) |
| `total_reviews` | INTEGER | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ–¥–≥—É–∫—ñ–≤ |
| `is_verified` | BOOLEAN | –ß–∏ –≤–µ—Ä–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π |
| `created_at` | TIMESTAMP | –î–∞—Ç–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó |
| `updated_at` | TIMESTAMP | –î–∞—Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è |

**–Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_users_email` - —à–≤–∏–¥–∫–∏–π –ø–æ—à—É–∫ –ø–æ email
- `idx_users_city` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ –º—ñ—Å—Ç—É
- `idx_users_role` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ —Ä–æ–ª—ñ
- `idx_users_verified` - –ø–æ—à—É–∫ –≤–µ—Ä–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

---

### 2. **categories** - –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó –ø–æ—Å–ª—É–≥
–î–æ–≤—ñ–¥–Ω–∏–∫ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø–æ—Å–ª—É–≥.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å |
|------|-----|------|
| `category_id` | SERIAL PRIMARY KEY | ID –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó |
| `name` | VARCHAR(100) UNIQUE | –ù–∞–∑–≤–∞ (—É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é) |
| `slug` | VARCHAR(100) UNIQUE | URL-friendly –Ω–∞–∑–≤–∞ |
| `emoji` | VARCHAR(10) | –ï–º–æ–¥–∑—ñ –¥–ª—è —ñ–∫–æ–Ω–∫–∏ |
| `description` | TEXT | –û–ø–∏—Å –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó |
| `sort_order` | INTEGER | –ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è |

**–ü—Ä–∏–∫–ª–∞–¥–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π:**
- üè† –ü–æ–±—É—Ç
- üöó –ê–≤—Ç–æ
- üíá –ö—Ä–∞—Å–∞
- üéì –û—Å–≤—ñ—Ç–∞
- üß∞ –†–µ–º–æ–Ω—Ç
- üíº –ë—ñ–∑–Ω–µ—Å
- üíª IT
- ‚öïÔ∏è –ú–µ–¥–∏—Ü–∏–Ω–∞
- üé® –¢–≤–æ—Ä—á—ñ—Å—Ç—å

---

### 3. **services** - –ü–æ—Å–ª—É–≥–∏
–û–≥–æ–ª–æ—à–µ–Ω–Ω—è –ø—Ä–æ –ø–æ—Å–ª—É–≥–∏ –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å |
|------|-----|------|
| `service_id` | SERIAL PRIMARY KEY | ID –ø–æ—Å–ª—É–≥–∏ |
| `user_id` | INTEGER FK | –ê–≤—Ç–æ—Ä –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è |
| `category_id` | INTEGER FK | –ö–∞—Ç–µ–≥–æ—Ä—ñ—è |
| `title` | VARCHAR(255) | –ù–∞–∑–≤–∞ –ø–æ—Å–ª—É–≥–∏ |
| `description` | TEXT | –î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å |
| `price_from` | DECIMAL(10,2) | –¶—ñ–Ω–∞ –≤—ñ–¥ |
| `price_to` | DECIMAL(10,2) | –¶—ñ–Ω–∞ –¥–æ |
| `price_unit` | VARCHAR(50) | –û–¥–∏–Ω–∏—Ü—è –≤–∏–º—ñ—Ä—É (–≥—Ä–Ω, –≥—Ä–Ω/–≥–æ–¥) |
| `city` | VARCHAR(100) | –ú—ñ—Å—Ç–æ –Ω–∞–¥–∞–Ω–Ω—è –ø–æ—Å–ª—É–≥–∏ |
| `created_at` | TIMESTAMP | –î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è |
| `updated_at` | TIMESTAMP | –î–∞—Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è |

**–Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_services_user` - –ø–æ—Å–ª—É–≥–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `idx_services_category` - –ø–æ—Å–ª—É–≥–∏ –≤ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
- `idx_services_city` - –ø–æ—Å–ª—É–≥–∏ –≤ –º—ñ—Å—Ç—ñ

---

### 4. **business_info** - –ë—ñ–∑–Ω–µ—Å-–ø—Ä–æ—Ñ—ñ–ª—ñ
–†–æ–∑—à–∏—Ä–µ–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –¥–ª—è –±—ñ–∑–Ω–µ—Å-–∞–∫–∞—É–Ω—Ç—ñ–≤.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å |
|------|-----|------|
| `business_id` | SERIAL PRIMARY KEY | ID –±—ñ–∑–Ω–µ—Å—É |
| `user_id` | INTEGER FK UNIQUE | –í–ª–∞—Å–Ω–∏–∫ (1:1) |
| `company_name` | VARCHAR(255) | –ù–∞–∑–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—ó |
| `description` | TEXT | –û–ø–∏—Å –±—ñ–∑–Ω–µ—Å—É |
| `address` | TEXT | –§—ñ–∑–∏—á–Ω–∞ –∞–¥—Ä–µ—Å–∞ |
| `work_hours` | TEXT | –ì–æ–¥–∏–Ω–∏ —Ä–æ–±–æ—Ç–∏ |
| `website` | VARCHAR(255) | –í–µ–±-—Å–∞–π—Ç |
| `social_links` | JSONB | –°–æ—Ü. –º–µ—Ä–µ–∂—ñ |
| `gallery` | JSONB | –ì–∞–ª–µ—Ä–µ—è —Ñ–æ—Ç–æ (–º–∞—Å–∏–≤ URL) |

**–ü—Ä–∏–∫–ª–∞–¥ JSONB:**
```json
{
  "social_links": {
    "facebook": "cleanpro.ua",
    "instagram": "@cleanpro_kyiv"
  },
  "gallery": [
    "https://cdn.example.com/photo1.jpg",
    "https://cdn.example.com/photo2.jpg"
  ]
}
```

---

### 5. **reviews** - –í—ñ–¥–≥—É–∫–∏
–°–∏—Å—Ç–µ–º–∞ –≤—ñ–¥–≥—É–∫—ñ–≤ —Ç–∞ –æ—Ü—ñ–Ω–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å |
|------|-----|------|
| `review_id` | SERIAL PRIMARY KEY | ID –≤—ñ–¥–≥—É–∫—É |
| `reviewer_id` | INTEGER FK | –•—Ç–æ –∑–∞–ª–∏—à–∏–≤ |
| `reviewed_id` | INTEGER FK | –ö–æ–º—É –∑–∞–ª–∏—à–∏–ª–∏ |
| `rating` | INTEGER (1-5) | –û—Ü—ñ–Ω–∫–∞ |
| `comment` | TEXT | –¢–µ–∫—Å—Ç –≤—ñ–¥–≥—É–∫—É |
| `created_at` | TIMESTAMP | –î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è |

**–£–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å:** –û–¥–∏–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –∑–∞–ª–∏—à–∏—Ç–∏ –ª–∏—à–µ –æ–¥–∏–Ω –≤—ñ–¥–≥—É–∫ —ñ–Ω—à–æ–º—É.

**–Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_reviews_reviewed` - –≤—Å—ñ –≤—ñ–¥–≥—É–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `idx_reviews_rating` - —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É

**–¢—Ä–∏–≥–µ—Ä:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è `avg_rating` —Ç–∞ `total_reviews` –≤ —Ç–∞–±–ª–∏—Ü—ñ `users`.

---

### 6. **messages** - –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
–ü—Ä–∏–≤–∞—Ç–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –º—ñ–∂ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å |
|------|-----|------|
| `message_id` | SERIAL PRIMARY KEY | ID –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è |
| `sender_id` | INTEGER FK | –í—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫ |
| `receiver_id` | INTEGER FK | –û—Ç—Ä–∏–º—É–≤–∞—á |
| `text` | TEXT | –¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è |
| `is_read` | BOOLEAN | –ß–∏ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ |
| `created_at` | TIMESTAMP | –î–∞—Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ |

**–Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_messages_sender` - –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `idx_messages_receiver` - –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `idx_messages_unread` - –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

---

### 7. **favorites** - –û–±—Ä–∞–Ω–µ
–ó–∞–∫–ª–∞–¥–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å |
|------|-----|------|
| `favorite_id` | SERIAL PRIMARY KEY | ID –∑–∞–ø–∏—Å—É |
| `user_id` | INTEGER FK | –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á |
| `target_user_id` | INTEGER FK | –ó–±–µ—Ä–µ–∂–µ–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å |
| `created_at` | TIMESTAMP | –ö–æ–ª–∏ –¥–æ–¥–∞–Ω–æ |

**–£–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å:** –ù–µ –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –æ–¥–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–≤—ñ—á—ñ.

---

### 8. **reports** - –°–∫–∞—Ä–≥–∏
–°–∏—Å—Ç–µ–º–∞ —Å–∫–∞—Ä–≥ –Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å |
|------|-----|------|
| `report_id` | SERIAL PRIMARY KEY | ID —Å–∫–∞—Ä–≥–∏ |
| `reporter_id` | INTEGER FK | –•—Ç–æ —Å–∫–∞—Ä–∂–∏—Ç—å—Å—è |
| `reported_id` | INTEGER FK | –ù–∞ –∫–æ–≥–æ —Å–∫–∞—Ä–≥–∞ |
| `reason` | TEXT | –ü—Ä–∏—á–∏–Ω–∞ —Å–∫–∞—Ä–≥–∏ |
| `status` | VARCHAR(20) | pending/reviewed/resolved |
| `created_at` | TIMESTAMP | –î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è |
| `resolved_at` | TIMESTAMP | –î–∞—Ç–∞ –≤–∏—Ä—ñ—à–µ–Ω–Ω—è |

**–Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_reports_status` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ —Å—Ç–∞—Ç—É—Å—É
- `idx_reports_reported` - –≤—Å—ñ —Å–∫–∞—Ä–≥–∏ –Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

---

### 9. **notifications** - –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è
–°–∏—Å—Ç–µ–º–Ω—ñ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å |
|------|-----|------|
| `notification_id` | SERIAL PRIMARY KEY | ID —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è |
| `user_id` | INTEGER FK | –û–¥–µ—Ä–∂—É–≤–∞—á |
| `type` | VARCHAR(50) | –¢–∏–ø (new_message, new_review) |
| `title` | VARCHAR(255) | –ó–∞–≥–æ–ª–æ–≤–æ–∫ |
| `message` | TEXT | –¢–µ–∫—Å—Ç —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è |
| `related_user_id` | INTEGER FK | –ü–æ–≤'—è–∑–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á |
| `is_read` | BOOLEAN | –ß–∏ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ |
| `created_at` | TIMESTAMP | –î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è |

**–Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_notifications_user` - —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `idx_notifications_unread` - –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω—ñ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è

---

### 10. **sessions** - –°–µ—Å—ñ—ó
–ê–∫—Ç–∏–≤–Ω—ñ —Å–µ—Å—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (JWT —Ç–æ–∫–µ–Ω–∏).

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å |
|------|-----|------|
| `session_id` | SERIAL PRIMARY KEY | ID —Å–µ—Å—ñ—ó |
| `user_id` | INTEGER FK | –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á |
| `token` | VARCHAR(500) UNIQUE | JWT —Ç–æ–∫–µ–Ω |
| `ip_address` | VARCHAR(45) | IP –∞–¥—Ä–µ—Å–∞ |
| `user_agent` | TEXT | User Agent –±—Ä–∞—É–∑–µ—Ä–∞ |
| `expires_at` | TIMESTAMP | –¢–µ—Ä–º—ñ–Ω –¥—ñ—ó |
| `created_at` | TIMESTAMP | –î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è |

**–Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_sessions_token` - —à–≤–∏–¥–∫–∏–π –ø–æ—à—É–∫ –ø–æ —Ç–æ–∫–µ–Ω—É
- `idx_sessions_user` - –≤—Å—ñ —Å–µ—Å—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

---

### 11. **search_logs** - –õ–æ–≥–∏ –ø–æ—à—É–∫—É
–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ –ø–æ—à—É–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å |
|------|-----|------|
| `log_id` | SERIAL PRIMARY KEY | ID –∑–∞–ø–∏—Å—É |
| `user_id` | INTEGER FK | –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á (nullable) |
| `query` | VARCHAR(255) | –ü–æ—à—É–∫–æ–≤–∏–π –∑–∞–ø–∏—Ç |
| `category_id` | INTEGER FK | –ö–∞—Ç–µ–≥–æ—Ä—ñ—è —Ñ—ñ–ª—å—Ç—Ä–∞ |
| `city` | VARCHAR(100) | –ú—ñ—Å—Ç–æ —Ñ—ñ–ª—å—Ç—Ä–∞ |
| `results_count` | INTEGER | –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ |
| `created_at` | TIMESTAMP | –î–∞—Ç–∞ –ø–æ—à—É–∫—É |

**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:** –ê–Ω–∞–ª—ñ–∑ –ø–æ–ø—É–ª—è—Ä–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤, –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π.

---

### 12. **cities** - –ú—ñ—Å—Ç–∞
–î–æ–≤—ñ–¥–Ω–∏–∫ –º—ñ—Å—Ç –£–∫—Ä–∞—ó–Ω–∏.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å |
|------|-----|------|
| `city_id` | SERIAL PRIMARY KEY | ID –º—ñ—Å—Ç–∞ |
| `name` | VARCHAR(100) UNIQUE | –ù–∞–∑–≤–∞ –º—ñ—Å—Ç–∞ |
| `region` | VARCHAR(100) | –û–±–ª–∞—Å—Ç—å |
| `latitude` | DECIMAL(10,8) | –®–∏—Ä–æ—Ç–∞ |
| `longitude` | DECIMAL(11,8) | –î–æ–≤–≥–æ—Ç–∞ |
| `users_count` | INTEGER | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ |
| `services_count` | INTEGER | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Å–ª—É–≥ |

**–ü—Ä–∏–∫–ª–∞–¥–∏:** –ö–∏—ó–≤, –•–∞—Ä–∫—ñ–≤, –û–¥–µ—Å–∞, –î–Ω—ñ–ø—Ä–æ, –õ—å–≤—ñ–≤...

---

## –ó–≤'—è–∑–∫–∏

### –û–¥–∏–Ω-–¥–æ-–±–∞–≥–∞—Ç—å–æ—Ö (1:N)
- `users` ‚Üí `services` (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î –±–∞–≥–∞—Ç–æ –ø–æ—Å–ª—É–≥)
- `users` ‚Üí `reviews` (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–ø–∏—Å–∞–≤ –±–∞–≥–∞—Ç–æ –≤—ñ–¥–≥—É–∫—ñ–≤)
- `categories` ‚Üí `services` (–∫–∞—Ç–µ–≥–æ—Ä—ñ—è –º—ñ—Å—Ç–∏—Ç—å –±–∞–≥–∞—Ç–æ –ø–æ—Å–ª—É–≥)
- `users` ‚Üí `messages` (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—ñ–¥–ø—Ä–∞–≤–∏–≤ –±–∞–≥–∞—Ç–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å)

### –ë–∞–≥–∞—Ç–æ-–¥–æ-–±–∞–≥–∞—Ç—å–æ—Ö (M:N)
- `users` ‚Üî `users` —á–µ—Ä–µ–∑ `favorites` (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –º–∞—Ç–∏ –±–∞–≥–∞—Ç–æ –æ–±—Ä–∞–Ω–∏—Ö)
- `users` ‚Üî `users` —á–µ—Ä–µ–∑ `reviews` (–≤–∑–∞—î–º–Ω—ñ –≤—ñ–¥–≥—É–∫–∏)

### –û–¥–∏–Ω-–¥–æ-–æ–¥–Ω–æ–≥–æ (1:1)
- `users` ‚Üí `business_info` (–±—ñ–∑–Ω–µ—Å-–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î –æ–¥–∏–Ω —Ä–æ–∑—à–∏—Ä–µ–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å)

---

## –Ü–Ω–¥–µ–∫—Å–∏

### –ö—Ä–∏—Ç–∏—á–Ω—ñ —ñ–Ω–¥–µ–∫—Å–∏ –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

```sql
-- –ü–æ—à—É–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_city ON users(city);
CREATE INDEX idx_users_role ON users(role);

-- –ö–∞—Ç–∞–ª–æ–≥ –ø–æ—Å–ª—É–≥
CREATE INDEX idx_services_category ON services(category_id);
CREATE INDEX idx_services_city ON services(city);
CREATE INDEX idx_services_user ON services(user_id);

-- –í—ñ–¥–≥—É–∫–∏ —Ç–∞ —Ä–µ–π—Ç–∏–Ω–≥–∏
CREATE INDEX idx_reviews_reviewed ON reviews(reviewed_id);
CREATE INDEX idx_reviews_rating ON reviews(rating DESC);

-- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
CREATE INDEX idx_messages_receiver ON messages(receiver_id, is_read);
CREATE INDEX idx_messages_sender ON messages(sender_id);
```

---

## –¢—Ä–∏–≥–µ—Ä–∏

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è `updated_at`

```sql
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ language 'plpgsql';
```

**–ó–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ:** `users`, `services`

### 2. –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–µ–π—Ç–∏–Ω–≥—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

```sql
CREATE OR REPLACE FUNCTION update_user_rating()
RETURNS TRIGGER AS $$
BEGIN
    UPDATE users
    SET avg_rating = (
        SELECT AVG(rating)::DECIMAL(3,2)
        FROM reviews
        WHERE reviewed_id = NEW.reviewed_id
    ),
    total_reviews = (
        SELECT COUNT(*)
        FROM reviews
        WHERE reviewed_id = NEW.reviewed_id
    )
    WHERE user_id = NEW.reviewed_id;
    
    RETURN NEW;
END;
$$ language 'plpgsql';
```

**–¢—Ä–∏–≥–µ—Ä:** `trigger_update_rating` –Ω–∞ `reviews` (AFTER INSERT/UPDATE)

---

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

**–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è `.env`:**
```env
DATABASE_URL="postgresql://username:password@localhost:5432/sviydliasvoyikh?schema=public"
```

### –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

```bash
# 1. –°—Ç–≤–æ—Ä–∏—Ç–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö
psql -U postgres -c "CREATE DATABASE sviydliasvoyikh;"

# 2. –í–∏–∫–æ–Ω–∞—Ç–∏ —Å—Ö–µ–º—É
psql -U postgres -d sviydliasvoyikh -f database/schema.sql

# 3. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ seed –¥–∞–Ω—ñ
psql -U postgres -d sviydliasvoyikh -f database/seed.sql

# 4. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ Prisma
npx prisma generate
npx prisma db push
```

### –ü—Ä–∏–∫–ª–∞–¥–∏ –∑–∞–ø–∏—Ç—ñ–≤ —á–µ—Ä–µ–∑ Prisma

#### –û—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –±—ñ–∑–Ω–µ—Å-—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é

```typescript
const user = await prisma.user.findUnique({
  where: { email: 'user@example.com' },
  include: {
    businessInfo: true,
    services: {
      include: {
        category: true
      }
    },
    reviewsReceived: {
      include: {
        reviewer: {
          select: {
            firstName: true,
            lastName: true,
            avatarUrl: true
          }
        }
      }
    }
  }
});
```

#### –ü–æ—à—É–∫ –ø–æ—Å–ª—É–≥ –∑ —Ñ—ñ–ª—å—Ç—Ä–∞–º–∏

```typescript
const services = await prisma.service.findMany({
  where: {
    city: '–ö–∏—ó–≤',
    categoryId: 1,
    priceFrom: { gte: 500 },
    priceTo: { lte: 2000 }
  },
  include: {
    user: {
      select: {
        firstName: true,
        lastName: true,
        avatarUrl: true,
        avgRating: true,
        isVerified: true
      }
    },
    category: true
  },
  orderBy: {
    user: {
      avgRating: 'desc'
    }
  }
});
```

#### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—ñ–¥–≥—É–∫—É

```typescript
const review = await prisma.review.create({
  data: {
    reviewerId: currentUserId,
    reviewedId: targetUserId,
    rating: 5,
    comment: '–ß—É–¥–æ–≤–∏–π –º–∞–π—Å—Ç–µ—Ä! –†–µ–∫–æ–º–µ–Ω–¥—É—é!'
  }
});

// –†–µ–π—Ç–∏–Ω–≥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ —Ç—Ä–∏–≥–µ—Ä
```

#### –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

```typescript
const message = await prisma.message.create({
  data: {
    senderId: currentUserId,
    receiverId: targetUserId,
    text: '–î–æ–±—Ä–æ–≥–æ –¥–Ω—è! –¶—ñ–∫–∞–≤–∏—Ç—å –≤–∞—à–∞ –ø–æ—Å–ª—É–≥–∞.'
  }
});

// –°—Ç–≤–æ—Ä–∏—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
await prisma.notification.create({
  data: {
    userId: targetUserId,
    type: 'new_message',
    title: '–ù–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è',
    message: `${senderName} –Ω–∞–¥—ñ—Å–ª–∞–≤ –≤–∞–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è`,
    relatedUserId: currentUserId
  }
});
```

---

## –ë–µ–∑–ø–µ–∫–∞

### 1. –ü–∞—Ä–æ–ª—ñ
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **bcrypt** –¥–ª—è —Ö–µ—à—É–≤–∞–Ω–Ω—è
- –ú—ñ–Ω—ñ–º—É–º 10 rounds –¥–ª—è salt
- –ü–∞—Ä–æ–ª—å –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É –≤–∏–≥–ª—è–¥—ñ

### 2. SQL Injection
- **Prisma ORM** –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞—Ö–∏—â–∞—î –≤—ñ–¥ SQL Injection
- –í—Å—ñ –∑–∞–ø–∏—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω—ñ

### 3. –ü—Ä–∏–≤–∞—Ç–Ω—ñ—Å—Ç—å
- –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É –≤–∏–¥–∏–º–∏–π —Ç—ñ–ª—å–∫–∏ –≤–µ—Ä–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º
- Email –Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –ø—É–±–ª—ñ—á–Ω–æ
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

### 4. –ê–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
- JWT —Ç–æ–∫–µ–Ω–∏ –∑ –æ–±–º–µ–∂–µ–Ω–∏–º —Ç–µ—Ä–º—ñ–Ω–æ–º –¥—ñ—ó
- Refresh —Ç–æ–∫–µ–Ω–∏ –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
- –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–∏—Ö —Å–µ—Å—ñ–π —É —Ç–∞–±–ª–∏—Ü—ñ `sessions`

---

## –ú—ñ–≥—Ä–∞—Ü—ñ—ó

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –º—ñ–≥—Ä–∞—Ü—ñ—ó

```bash
# –°—Ç–≤–æ—Ä–∏—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—é –ø—ñ—Å–ª—è –∑–º—ñ–Ω –≤ schema.prisma
npx prisma migrate dev --name add_new_field

# –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó –≤ production
npx prisma migrate deploy
```

### –í—ñ–¥–∫–∞—Ç –º—ñ–≥—Ä–∞—Ü—ñ—ó

```bash
# –í—ñ–¥–∫–æ—Ç–∏—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—é –º—ñ–≥—Ä–∞—Ü—ñ—é
npx prisma migrate resolve --rolled-back <migration_name>
```

---

## –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è

### 1. –Ü–Ω–¥–µ–∫—Å–∏
- –†–µ–≥—É–ª—è—Ä–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—ñ–≤
- –í–∏–¥–∞–ª—è—Ç–∏ –Ω–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ —ñ–Ω–¥–µ–∫—Å–∏
- –î–æ–¥–∞–≤–∞—Ç–∏ composite indexes –¥–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤

### 2. –ö–µ—à—É–≤–∞–Ω–Ω—è
- Redis –¥–ª—è –∫–µ—à—É–≤–∞–Ω–Ω—è –ø–æ–ø—É–ª—è—Ä–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
- –ö–µ—à —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä—ñ–π (–∑–º—ñ–Ω—é—î—Ç—å—Å—è —Ä—ñ–¥–∫–æ)
- –ö–µ—à —Ç–æ–ø-—Ä–µ–π—Ç–∏–Ω–≥–æ–≤–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

### 3. –ü–∞—Ä—Ç–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è
–ü—Ä–∏ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—ñ:
- –ü–∞—Ä—Ç–∏—Ü—ñ–æ–Ω—É–≤–∞—Ç–∏ —Ç–∞–±–ª–∏—Ü—é `messages` –ø–æ –¥–∞—Ç–∞—Ö
- –ü–∞—Ä—Ç–∏—Ü—ñ–æ–Ω—É–≤–∞—Ç–∏ `search_logs` –ø–æ –º—ñ—Å—è—Ü—è—Ö
- –ê—Ä—Ö—ñ–≤—É–≤–∞—Ç–∏ —Å—Ç–∞—Ä—ñ –¥–∞–Ω—ñ

---

## –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

### –ö—Ä–∏—Ç–∏—á–Ω—ñ –º–µ—Ç—Ä–∏–∫–∏

```sql
-- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
SELECT COUNT(*) FROM users WHERE is_verified = TRUE;

-- –°–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –≤—ñ–¥–≥—É–∫—É
SELECT AVG(EXTRACT(EPOCH FROM (created_at - updated_at))) 
FROM messages 
WHERE is_read = TRUE;

-- –ù–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
SELECT c.name, COUNT(s.service_id) as services_count
FROM categories c
LEFT JOIN services s ON c.category_id = s.category_id
GROUP BY c.name
ORDER BY services_count DESC;

-- –¢–æ–ø –º—ñ—Å—Ç –ø–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
SELECT city, COUNT(*) as user_count
FROM users
WHERE is_verified = TRUE
GROUP BY city
ORDER BY user_count DESC
LIMIT 10;
```

---

## Backup —Ç–∞ –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è backup

```bash
# Full backup
pg_dump -U postgres -d sviydliasvoyikh -F c -f backup_$(date +%Y%m%d).dump

# –¢—ñ–ª—å–∫–∏ —Å—Ö–µ–º–∞
pg_dump -U postgres -d sviydliasvoyikh --schema-only -f schema_backup.sql

# –¢—ñ–ª—å–∫–∏ –¥–∞–Ω—ñ
pg_dump -U postgres -d sviydliasvoyikh --data-only -f data_backup.sql
```

### –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è

```bash
# –ó –ø–æ–≤–Ω–æ–≥–æ backup
pg_restore -U postgres -d sviydliasvoyikh -c backup_20240101.dump

# –ó SQL —Ñ–∞–π–ª—É
psql -U postgres -d sviydliasvoyikh -f schema_backup.sql
```

---

## –í–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è

- **–í–µ—Ä—Å—ñ—è 1.0** (–ü–æ—Ç–æ—á–Ω–∞)
  - 12 –æ—Å–Ω–æ–≤–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü—å
  - –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Ä–æ–ª–µ–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
  - –°–∏—Å—Ç–µ–º–∞ –≤—ñ–¥–≥—É–∫—ñ–≤ —Ç–∞ —Ä–µ–π—Ç–∏–Ω–≥—ñ–≤
  - –ü—Ä–∏–≤–∞—Ç–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

- **–ó–∞–ø–ª–∞–Ω–æ–≤–∞–Ω–∞ –≤–µ—Ä—Å—ñ—è 1.1**
  - –î–æ–¥–∞—Ç–∏ —Ç–∞–±–ª–∏—Ü—é `transactions` –¥–ª—è –ø–ª–∞—Ç–µ–∂—ñ–≤
  - –î–æ–¥–∞—Ç–∏ `user_settings` –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
  - –†–æ–∑—à–∏—Ä–∏—Ç–∏ `services` –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –ø–æ—Å–ª—É–≥

---

## –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–î–ª—è –ø–∏—Ç–∞–Ω—å —â–æ–¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:
- üìß Email: dev@sviydliasvoyikh.ua
- üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è: [DATABASE.md](./DATABASE.md)
- üîß Prisma –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è: https://www.prisma.io/docs/

---

**–û—Å—Ç–∞–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω–∞:** 2024
**–ê–≤—Ç–æ—Ä:** –°–í–Ü–ô –î–õ–Ø –°–í–û–á–• Team
