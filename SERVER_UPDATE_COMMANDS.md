# Команды для решения конфликтов на сервере
# Выполняйте по очереди после подключения к серверу

# 1. Подключитесь к серверу
ssh root@sviydlyasvoih.com.ua

# 2. Перейдите в директорию проекта
cd /var/www/sviydlyasvoih/platform-svoi

# 3. Сделайте backup .env
cp .env .env.local.backup

# 4. Удалите проблемную миграцию (она уже есть в репозитории)
rm -rf prisma/migrations/20251103200601_/

# 5. Сбросьте изменения .env
git checkout -- .env

# 6. Получите последние изменения
git pull origin main

# 7. Восстановите локальные настройки .env
# ВАЖНО: Откройте .env.local.backup и перенесите нужные настройки в .env
nano .env
# Или используйте команду для переноса основных настроек:
# grep -E "DATABASE_URL|JWT_SECRET|UPLOADS_DIR" .env.local.backup

# 8. Установите зависимости (если нужно)
npm install

# 9. Пересоберите проект
npm run build

# 10. Перезапустите PM2
pm2 restart sviy-web

# 11. Проверьте логи
pm2 logs sviy-web --lines 30

# 12. Проверьте статус
pm2 status

# 13. Тестирование
# Откройте сайт и проверьте:
# - Регистрацию нового пользователя
# - Загрузку фото профиля
# - Создание услуги с изображением
