# üöÄ –§—ñ–Ω–∞–ª—å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ –¥–ª—è —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —ñ–¥–µ–∞–ª—å–Ω–æ—ó –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ –£–¶–ú

## –©–æ –±—É–ª–æ –∑—Ä–æ–±–ª–µ–Ω–æ

### ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ
1. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è** - –î–æ–¥–∞–Ω–æ `withAuth` middleware –¥–æ –≤—Å—ñ—Ö admin endpoints
2. **–í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É** - –ó–Ω–∞—á–æ–∫ "–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –£–¶–ú" —Ç–µ–ø–µ—Ä –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è –≤ –ø—Ä–æ—Ñ—ñ–ª—ñ
3. **TypeScript –ø–æ–º–∏–ª–∫–∏** - –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ `(prisma as any)` —Ç–∞ `(user as any)` –¥–ª—è –æ–±—Ö–æ–¥—É –ø–æ–º–∏–ª–æ–∫ –¥–æ regenerate
4. **–ê–≤—Ç–æ–Ω–æ–º–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –ê–¥–º—ñ–Ω –Ω–µ –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –∑–≤–∏—á–∞–π–Ω–∏–π —Å–∞–π—Ç

### üé® –í—ñ–∑—É–∞–ª—å–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ "–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –£–¶–ú"
- **–ó–µ–ª–µ–Ω–∏–π –∑–Ω–∞—á–æ–∫** –Ω–∞ –∞–≤–∞—Ç–∞—Ä—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–∑–Ω–∏–∑—É —Å–ø—Ä–∞–≤–∞)
- **–ó–µ–ª–µ–Ω–∏–π –±–µ–π–¥–∂** –ø–æ—Ä—É—á –∑ —ñ–º'—è–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ —Ç–µ–∫—Å—Ç–æ–º "–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –£–¶–ú"
- –í—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ `ucmVerified = true`

## üìã –ö–æ–º–∞–Ω–¥–∏ –¥–ª—è VPS

### 1. –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ VPS
\`\`\`bash
ssh root@your-vps-ip
\`\`\`

### 2. –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –ø—Ä–æ–µ–∫—Ç—É
\`\`\`bash
cd /var/www/sviydlyasvoyikh/platform-svoy#
\`\`\`

### 3. –û–Ω–æ–≤–∏—Ç–∏ –∫–æ–¥ –∑ Git
\`\`\`bash
git pull origin main
\`\`\`

### 4. –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ SQL –º—ñ–≥—Ä–∞—Ü—ñ—é –¥–ª—è ucm_verified
\`\`\`bash
PGPASSWORD=postgres psql -U postgres -d sviydlyasvoyikh -f database/migrations/20251125_add_ucm_verified.sql
\`\`\`

### 5. –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ Prisma Client
\`\`\`bash
npx prisma generate
\`\`\`

### 6. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
\`\`\`bash
npm install
\`\`\`

### 7. –ó—ñ–±—Ä–∞—Ç–∏ –ø—Ä–æ–µ–∫—Ç
\`\`\`bash
npm run build
\`\`\`

### 8. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ PM2
\`\`\`bash
pm2 restart sviy-web
\`\`\`

### 9. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å —Ç–∞ –ª–æ–≥–∏
\`\`\`bash
pm2 status
pm2 logs sviy-web --lines 100
\`\`\`

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### 1. –£–≤—ñ–π—Ç–∏ —è–∫ –∞–¥–º—ñ–Ω
- URL: `https://your-domain.com/auth/login`
- Email: `admin@gmail.com`
- –ü–∞—Ä–æ–ª—å: `sviyadmin1354`
- –ú–∞—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ `/admin`

### 2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤–∏–¥–∞—á—É –£–¶–ú
1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ **–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏**
2. –ù–∞—Ç–∏—Å–Ω—É—Ç–∏ **–í–∏–¥–∞—Ç–∏ –£–¶–ú** –Ω–∞ –±—É–¥—å-—è–∫–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ
3. –í–∫–∞–∑–∞—Ç–∏ —Å—É–º—É, –ø—Ä–∏—á–∏–Ω—É, –æ–ø–∏—Å
4. –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏
5. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –±–∞–ª–∞–Ω—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –æ–Ω–æ–≤–∏–≤—Å—è

### 3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—é
1. –ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ **–í–µ—Ä–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏**
2. –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏
3. –í—ñ–¥–∫—Ä–∏—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–Ω–µ –≤ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ)
4. –ú–∞—î –ø–æ–∫–∞–∑–∞—Ç–∏—Å—è:
   - –ó–µ–ª–µ–Ω–∏–π –∑–Ω–∞—á–æ–∫ –Ω–∞ –∞–≤–∞—Ç–∞—Ä—ñ (–∑–Ω–∏–∑—É —Å–ø—Ä–∞–≤–∞)
   - –ó–µ–ª–µ–Ω–∏–π –±–µ–π–¥–∂ "–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –£–¶–ú" –ø–æ—Ä—É—á –∑ —ñ–º'—è–º

### 4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–µ—Ä–µ–ø–∏—Å–∫–∏
1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ **–ü–µ—Ä–µ–ø–∏—Å–∫–∏**
2. –û–±—Ä–∞—Ç–∏ –ø–µ—Ä–µ–ø–∏—Å–∫—É –∑—ñ —Å–ø–∏—Å–∫—É
3. –ú–∞—î –ø–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

## üéØ –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ

### –ì–æ–ª–æ–≤–Ω–∞ –ø–∞–Ω–µ–ª—å (`/admin`)
- ‚úÖ –ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ, –ø–æ—Å–ª—É–≥–∏, –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –£–¶–ú
- ‚úÖ –¢–æ–ø-10 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø–æ –±–∞–ª–∞–Ω—Å—É –£–¶–ú
- ‚úÖ –ù–æ–≤—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ 7 –¥–Ω—ñ–≤
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π –ø–æ —Ç–∏–ø–∞—Ö
- ‚úÖ –ö–Ω–æ–ø–∫–∞ **–í–∏—Ö—ñ–¥** (–õ–æ–≥–∞—É—Ç)

### –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ (`/admin/users-manage`)
- ‚úÖ –°–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—î—é
- ‚úÖ –ü–æ—à—É–∫ –ø–æ —ñ–º–µ–Ω—ñ, email, –º—ñ—Å—Ç—É
- ‚úÖ –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è (–¥–∞—Ç–∞, –±–∞–ª–∞–Ω—Å, —ñ–º'—è, –º—ñ—Å—Ç–æ)
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- ‚úÖ **–í–∏–¥–∞—á–∞ –£–¶–ú** - –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –∑ –≤–∏–±–æ—Ä–æ–º —Å—É–º–∏, –ø—Ä–∏—á–∏–Ω–∏, –æ–ø–∏—Å—É
- ‚úÖ **–í–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è –£–¶–ú** - –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è/–∑–Ω—è—Ç—Ç—è —Å—Ç–∞—Ç—É—Å—É "–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –£–¶–ú"

### –ü–µ—Ä–µ–ø–∏—Å–∫–∏ (`/admin/messages`)
- ‚úÖ –°–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –ø–µ—Ä–µ–ø–∏—Å–æ–∫
- ‚úÖ –ü–æ—à—É–∫ –ø–æ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- ‚úÖ –ü–µ—Ä–µ–≥–ª—è–¥ –≤—Å—ñ—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –ø–µ—Ä–µ–ø–∏—Å–∫–∏
- ‚úÖ –ü–∞–≥—ñ–Ω–∞—Ü—ñ—è

### –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó (`/admin/transactions`)
- ‚úÖ –Ü—Å—Ç–æ—Ä—ñ—è –≤—Å—ñ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π –£–¶–ú
- ‚úÖ –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ —Ç–∏–ø—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞—Ö
- ‚úÖ –ù–∞–π–±—ñ–ª—å—à—ñ –ø–µ—Ä–µ–∫–∞–∑–∏
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –ø–µ—Ä—ñ–æ–¥–∞–º–∏ (–¥–µ–Ω—å/—Ç–∏–∂–¥–µ–Ω—å/–º—ñ—Å—è—Ü—å)

## üîí –ë–µ–∑–ø–µ–∫–∞

### –ê–¥–º—ñ–Ω –Ω–µ –º–æ–∂–µ:
- ‚ùå –í—ñ–¥–∫—Ä–∏—Ç–∏ –∑–≤–∏—á–∞–π–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–µ–¥—ñ—Ä–µ–∫—Ç –Ω–∞ `/admin`)
- ‚ùå –ë–∞—á–∏—Ç–∏ Navbar, Footer, MobileNav
- ‚ùå –î–æ—Å—Ç—É–ø –¥–æ –ø—Ä–æ—Ñ—ñ–ª—é –±–µ–∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤ (API –ø–µ—Ä–µ–≤—ñ—Ä—è—î `isAdmin`)

### –ó–≤–∏—á–∞–π–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –º–æ–∂–µ:
- ‚ùå –í—ñ–¥–∫—Ä–∏—Ç–∏ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å (—Ä–µ–¥—ñ—Ä–µ–∫—Ç –Ω–∞ `/auth/login`)
- ‚ùå –í–∏–∫–ª–∏–∫–∞—Ç–∏ admin API (–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ `isAdmin` –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ)

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

### –ù–æ–≤—ñ –ø–æ–ª—è
- `users.is_admin` - Boolean (–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä —á–∏ –Ω—ñ)
- `users.ucm_verified` - Boolean (–ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –£–¶–ú)
- `users.balance_ucm` - Decimal (–±–∞–ª–∞–Ω—Å –£–¶–ú)

### –ù–æ–≤–∞ —Ç–∞–±–ª–∏—Ü—è
\`\`\`sql
ucm_transactions
- id (SERIAL PRIMARY KEY)
- user_id (INTEGER, FK –¥–æ users)
- amount (DECIMAL)
- reason (VARCHAR)
- description (TEXT)
- created_at (TIMESTAMP)
\`\`\`

## üêõ Troubleshooting

### –ü–æ–º–∏–ª–∫–∞ "–ù–µ–æ–±—Ö—ñ–¥–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è"
\`\`\`bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ JWT —Ç–æ–∫–µ–Ω –≤ cookies
# –û—á–∏—Å—Ç–∏—Ç–∏ cookies –±—Ä–∞—É–∑–µ—Ä–∞
# –ü–µ—Ä–µ–ª–æ–≥—ñ–Ω–∏—Ç–∏—Å—è
\`\`\`

### –ù–µ –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è —Å—Ç–∞—Ç—É—Å "–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –£–¶–ú"
\`\`\`sql
-- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–æ–ª–µ –≤ –ë–î
SELECT id, first_name, last_name, ucm_verified 
FROM users 
WHERE id = <user_id>;
\`\`\`

### TypeScript –ø–æ–º–∏–ª–∫–∏ –ø—ñ—Å–ª—è git pull
\`\`\`bash
npx prisma generate
npm run build
pm2 restart sviy-web
\`\`\`

### –ü–æ–º–∏–ª–∫–∞ "ucm_transactions table does not exist"
\`\`\`bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–∞–±–ª–∏—Ü—é
PGPASSWORD=postgres psql -U postgres -d sviydlyasvoyikh -c "\\d ucm_transactions"

# –Ø–∫—â–æ –Ω–µ —ñ—Å–Ω—É—î - —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≤—Ä—É—á–Ω—É
PGPASSWORD=postgres psql -U postgres -d sviydlyasvoyikh -c "
CREATE TABLE IF NOT EXISTS ucm_transactions (
    id SERIAL PRIMARY KEY,
    user_id INTEGER NOT NULL,
    amount DECIMAL(12,2) NOT NULL,
    reason VARCHAR(100) NOT NULL,
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE
);

CREATE INDEX idx_ucm_transactions_user ON ucm_transactions(user_id);
CREATE INDEX idx_ucm_transactions_created ON ucm_transactions(created_at);
CREATE INDEX idx_ucm_tx_user_reason ON ucm_transactions(user_id, reason);
"
\`\`\`

## üéâ –ì–æ—Ç–æ–≤–æ!

–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å –£–¶–ú –ø–æ–≤–Ω—ñ—Å—Ç—é —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ —Ç–∞ –≥–æ—Ç–æ–≤–∞ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è!

**–£–≤—ñ–π—Ç–∏:** `https://your-domain.com/auth/login` —è–∫ `admin@gmail.com`

**–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª:**
- ‚úÖ –í–∏–¥–∞—á–∞ –£–¶–ú –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º
- ‚úÖ –í–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–∑–Ω–∞—á–æ–∫ "–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –£–¶–ú")
- ‚úÖ –ü–µ—Ä–µ–≥–ª—è–¥ –≤—Å—ñ—Ö –ø–µ—Ä–µ–ø–∏—Å–æ–∫
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏
- ‚úÖ –ê–≤—Ç–æ–Ω–æ–º–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–µ–∑ –¥–æ—Å—Ç—É–ø—É –¥–æ –∑–≤–∏—á–∞–π–Ω–æ–≥–æ —Å–∞–π—Ç—É
